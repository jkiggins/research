\chapter{Synaptic Plasticity Using the Astrocyte Model in A Single Synapse
  Configuration} \label{chapter:obj2}

Astrocytes have suspected involvement in synaptic plasticity in both the
long \cite{min_2012} and short term \cite{pitta_2012}. A variety of
bio-inspired Astrocyte models have touched on short term plasticity, and
suggested modulation of classical Hebbian learning \cite{pitta_2016}. In
addition to the experimental evidence, Astrocytes are well placed to control
synaptic plasticity at many levels. Drilling down to the level of the
synapse, astrocytes monitor synaptic activity chemically, and respond
quickly with a variety of gliotransmitters, some of which are known to be
critical for LTP/LTD \cite{min_2012}. This fast local activity, which takes
the form of Ca2+ transients in Astrocyte end-foot processes is integrated
into a cell-level response, and can travel to distant synapses.

The goal in Chapter \ref{chapter:obj2} is to explore Astrocyte mediated synaptic
plasticity in a single synapse configuration, with a single LIF neuron. Existing
literature outlines many ways that Astrocytes are shown to, are suspected to, or
have been modeled to affect their external environment. Table
\ref{able:obj2_astro_features} outlines these features of Astrocyte and
Neuron-Astrocyte interactions that were common threads in background and related 
work (see Chapter \ref{chapter:background}). Within this chapter a number of
these features have equivalent configurations in the developed Astrocyte model,
and the effects of that configuration are explored further.

%If the table is too wide, replace \begin{table}[!htp]...\end{table} with
\begin{adjustwidth}{-2.5 cm}{-2.5 cm}\centering\begin{threeparttable}[!htb]
%% \begin{table}[!htp]\centering
\caption{Generated by Spread-LaTeX}\label{table:obj2_astro_features}
\scriptsize
\begin{tabular}{lrrrrrr}\toprule
Astrocyte Feature &Primary Author &References &Astrocyte Model &Functional Model in Primary Work &Adaption in This Work \\\midrule
Ca Mediated increase in Synaptic Current &Wade &Wade2011, Wade2012 &Lin and Rizel or Variation &IP3 = L(incoming spikes), d\_ca = L(IP3) + L(Ca) - NL(Ca) &i = z*w + i\_astro \\
Ca Mediated increase in Synaptic Weight &De Pitta &DePitta2016 &Lin and Rizel or Variation &Ca -> Glu -> increased PR &Threshold on Ca + constant multiplier to drive weight increase. Weight incrase is proportional to Ca, subject to a maximum change and scale factor \\
Modulation of Ca Based STDP Curve &De Pitta &DePitta2016 &Lin and Rizel or Variation &Shifting and modulation of Ca based two-threshold STDP &Differential Tau paramters on IP3 and K+ to achieve a similar result \\
Gating of LTP/LTD With D-Serine release &No primary Author & & &D-serine release opens the gate for synaptic plasticity through other mechanisms &The astrocyte drives plasticity, based on internal state including pesudo ip3, k+ and Ca \\
Working Memory &Gordleeva &Gordleeva2021 &Lin and Rizel or Variation &Astrocyte Calcium persists, and changes network sensitivity to prompt inputs & \\
\bottomrule
\end{tabular}
%% \end{table}
\end{threeparttable}\end{adjustwidth}

% TODO: Come up with a more generic name for Lin and Rizel model, and talk about
% how other models follow that basic approach, but that this work need not make
% a distinction between them.

\section{Spike-Timing Integration Plasticity}

One of the key features of the Astrocyte model developed in chapter
\ref{chapter:obj1} is the detection and integration of coincident spikes
effecting \ipt and \kp activity. In fact, looking at the calcium response alone
gives a response equivalent to the weight change associated with STDP (see
Section \ref{obj1:sec:classic_stdp}). With a simple threshold on \ca, the
Astrocyte model can implement classic STDP, and extend it, requiring multiple
pulse-pair events before weights change. This ``pulse-pair 
integration'' approach differs from classic STDP in a few key ways. Firstly,
weight updates are delayed, and determined by the value of \ca, possibly in
conjunction with \ipt and \kp. Any weight update will depend on a series of
causal or anti-causal spiking events instead of a single event. It may also be
that plasticity is delayed until some internal criteria are met, with weight
updates being proportional to the internal state. These types of effects are
hypothesized to increase stability of the plasticity rule, and add some
protection against noise. Furthermore an approach like this has support from
existing Neuroscience and Engineering literature, and is similar to CICR, where
calcium levels like and cause a release of gliotransmitters locally.

Equations \ref{eq:obj2:dw} and \ref{eq:obj2:ca_reset}
describe the weight update and \ca reset behavior. To evaluate the Astrocyte
model in this configuration a series of spike impulses are used. These are
groups of regularly firing inputs in a $1010101$ pattern, with sufficient space
between these groups for Astrocyte and Neuron states to settle.

\begin{align}
  d_w = H(ca - ca_{thr}) * \alpha_{ltp} + H(-ca - ca_{thr}) *
  \alpha_{ltd} \label{eq:obj2:dw} \\
  ca = ca * (1 - H(ca - ca_{thr}) +  H(-ca - ca_{thr})) \label{eq:obj2:ca_reset}
\end{align}

A slight variation allows the Astrocyte model to implement STDP, outlined in
Equations \ref{eq:obj2:stdp_dw}. In this case ca is reset every time-step.

\begin{align}
  d_w = ca / ca_{thr} \label{eq:obj2:stdp_dw} \\
\end{align}

Since the \ca response was already shown to mimic Classic STDP in \ref{chapter:obj1}
Equation \ref{eq:obj2:stdp_dw} will as well.

\subsection{Impulse Response}
Figure \ref{fig:ppi:impulse_istp} depicts the Astrocyte plasticity model with
$Ca_{thr}=2.5$, $\alpha_{ltp}=1.05$ and $\alpha_{ltd}=0.95$. In contrast, Figure
\ref{fig:ppi:impulse_stp} shows the behavior of a classic STDP (implemented by
the Astrocyte) with the same inputs and time-constant. The inputs themselves
consist of successive spikes, with 1ms between each. These spikes form groups
with enough time between for neuron and Astrocyte states to decay. Each group
has an additional spike compared to the last.

Comparing these graphs, it is clear that integrating
behavior of the Astrocyte model effects the learning process
significantly. Resulting in more stable behavior, and increasing synaptic weight
due to causal, correlated inputs. The key effect here can be seen considering
what happens when there are additional input spikes after a post-synaptic
spike. In this case classic STDP would decrease the weight, the Astrocyte rule
integrates this event into \ca. Those input spikes are eventually associated
with an additional down-stream spike, forming a causal relationship and \ca is
increased. Overall this leads to LTP, with the potential LTD events being
smoothed out.

\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_astro_0.svg}{
  Astrocyte response to successive spikes, displaying temporal pulse-pair
  integration}{fig:ppi:impulse_istp}{0.5}

\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_classic_0.svg}{
  Classic STDP response to successive spikes}{fig:ppi:impulse_stp}{0.4}

It is important to understand the situations under which the Astrocyte model
will converge, and compare that to classic STDP. Figures
\ref{fig:ppi:impulse_fixed_istp} and \ref{fig:ppi:impulse_fixed_stp} depict
responses to a similar series of spike impulses, but in this case each group of
spikes is the same length. There is a significant difference between the
behavior in this case, with the Astrocyte model quickly converging, while
classic STDP appears to overshoot a stable configuration, oscillating back and
forth. Figure \ref{fig:ppi:impulse_fixed_stp_diverge} shows the same simulation
on a longer timescale, showing that these oscillations continue.

% Astrocyte response to fixed length impulse inputs
\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_const_astro_0.svg}{Astrocyte
  response to a series of fixed length spike impulse inputs showing
  convergence}{fig:ppi:impulse_fixed_istp}{0.4}

% Classic STDP with fixed length impulse inputs
\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_const_astro_0.svg}{Classic
  STDP response to a series of fixed length spike impulse
  inputs}{fig:ppi:impulse_fixed_stp}{0.4}

% Classic STDP again, but with a longer simulation and only showing weights
\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_const_diverge_classic_0.svg}{Classic
  STDP response to fixed length spikes showing divergent
  behavior}{fig:ppi:impulse_fixed_stp_diverge}{0.4}

% Comparison with noisy inputs
Figures \ref{fig:ppi:impulse_noise_stp} and \ref{fig:ppi:impulse_noise_istp}
show the results of similar simulations, with the addition of uniformly random
noise in both cases. The probability specified, is the probability that a noisy
spike is received on the input side during any single time-step. Observing the
weight updates associated with the Astrocyte model, there isn't a significant
impact from the noise on the progression of weight modulation. In the case of
classic STDP, weight values fluctuate even further, adding to the already
unstable behavior.

% STDP response to impulse + uniform noise
\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_noise_classic_0.svg}{Classic
  STD response to impulse inputs with uniformly random
  noise}{fig:ppi:impulse_noise_stp}{0.4}

% Astro response to impulse + uniform noise
\asvgf{figures/artifacts/obj2/snn_1n1s1a_tp_pulse_noise_astro_0.svg}{Astrocyte
  response to impulse inputs with uniformly random
  noise}{fig:ppi:impulse_noise_istp}{0.4}

% Exploration of Weight update behavior with different parameters
The established baseline thus far, is that given this repeating (possibly
ramping up) spike impulse as an input, results in stable convergent weight
change from the Astrocyte model. In contrast, classic STDP shows instability
oscillation. This is only a single configuration however, and there are many
parameters that could be modified. An investigation into the following
parameters can help determine if the convergent/noisy behavior is stable,
and what other behaviors of the model may arise.

\begin{itemize}
\item Initial weight
\item Spike association
\item Time constants
\item $dw$ factors, $\alpha_{ltp}$ and $\alpha_{ltd}$
\item Neuron threshold
\end{itemize}

Figure \ref{fig:sweep:mu} shows a sweep of initial weight values, and
demonstrates the effect on weight convergence. In both cases, if weight values
are sufficiently low, the general lack of post-synaptic activity leads to little
or no weight update. With higher initial weight values the Astrocyte model was
able to converge as with previous simulations, while the STDP diverged towards a
weight value of zero. The Astrocyte model converged to a weight value as a
function of the initial weight, similar starting weights converging to the same,
or a similar point. This indicates there are multiple stable configurations
given these inputs and parameters. STDP on the other hand, doesn't exhibit the
same stability.


\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_mu_sweep_0.svg}{Classic STDP and
  Astrocyte Response to Initial Weight}{fig:sweep:mu}{0.4}

%% \asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_association_0.svg}{Classic
%%   STDP and Astrocyte Response to Different Spike Associations}{fig:sweep:assoc}{0.4}

\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_dw_factor_astro_0.svg}{Astrocyte
Response to Different Values for Weight Update Factor}{fig:sweep:astro_dw_factor}{0.4}

\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_dw_factor_classic_0.svg}{Classic
STDP Response to Different Values for Weight Update Factor}{fig:sweep:stdp_dw_factor}{0.4}

\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_lif_v_th_0.svg}{Classic STDP
  and Astrocyte Response to Different LIF Neuron Voltage Threshold Values}{fig:sweep:v_th}{0.4}

\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_tau_astro_0.svg}{Astrocyte
  Response to Different Values for K+ and IP3 Pathway $\tau$}{fig:sweep:astro_tau}{0.4}

\asvgf{figures/artifacts/obj2/snn_1n1a1s_tp_sweep_tau_classic_0.svg}{Classic
  STDP Response to Different Values for Pre and Post-synaptic Trace $\tau$}{fig:sweep:stdp_tau}{0.4}

% TODO: graph of noise response vs. noise percent and possibly type
